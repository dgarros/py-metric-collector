parser:
    command: show system processes extensive
    type: textfsm
    tags: [ PROCESS ]
    fields: [ CPU, MEMORY, RESERVE ]
    template: |
        # Chassis value will be null for single chassis routers.
        Value PROCESS (\w+)
        Value CPU (\d+\.\d+)
        Value MEMORY ([0-9]{2,}[MKG]{1})
        Value RESERVE ([0-9]+[MKG]{1})

        # Allway starts in 'Start' state.
        Start
        ^.*\s${MEMORY}\s+${RESERVE}.*\s${CPU}\%\s+${PROCESS} -> Record

        EOF

